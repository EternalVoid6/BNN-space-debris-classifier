# Digital IMC BNN Accelerator for Real-Time Space Debris Classification

> This repository contains the complete software implementation and hardware design for a Digital In-Memory Computing (IMC) accelerator. The system is built around a Binarized Neural Network (BNN) designed for ultra-low-power, real-time classification of space debris on edge devices like nanosatellites.

## The Problem: Orbital Congestion

The growing population of space debris poses a significant threat to active satellites. For small, power-constrained satellites (nanosatellites), autonomous, on-board collision avoidance is critical due to the communication latency with ground stations. Traditional AI models are too power-hungry for these edge applications.

This project solves this by designing a specialized hardware/software system that can make **zero-latency classification decisions** ("Debris" vs. "Safe") within an extreme power budget.

## The Solution: A Hybrid BNN System

Our solution is a **3-Layer Binarized Neural Network (BNN)**. BNNs replace computationally expensive multiplication operations with highly efficient bitwise **XNOR** and **Popcount** logic, making them ideal for hardware implementation.

The system uses a hardware/software co-design approach to maximize performance and efficiency:

!(Final_IMCfornow.drawio.png)

### System Architecture

| Component | Layer | Role & Logic | Implemented In |
| :--- | :--- | :--- | :--- |
| **Custom Hardware** | Binary Conv1 | **Primary Feature Extraction**. The most computationally intensive layer. Uses a 3x3 parallel XNOR array and Popcount for MAC+A (Multiply-Accumulate-Activate). | **Verilog/RTL** |
| **Host Software** | Binary Conv2 | **Feature Aggregation**. Takes the feature maps from the hardware and finds higher-level patterns. | **Python (PyTorch)** |
| **Host Software** | Binary FC | **Final Classification**. A dense layer that makes the final decision based on aggregated features. | **Python (PyTorch)** |

This hybrid approach dedicates a custom, power-efficient chip to the heavy lifting (Layer 1), while a general-purpose host processor handles the less demanding subsequent layers.

## Project Workflow

The project is developed using a two-track parallel workflow:

#### Track 1: Software (The "Golden Reference")
This track focuses on creating a perfect software simulation of the BNN in PyTorch. Its purpose is to:
1.  **Prove the Architecture**: Verify that the BNN model can learn and achieve high accuracy on the target task.
2.  **Train the Model**: Generate the final, trained binary weights (`W_final`) that will be loaded onto the hardware.
3.  **Generate Test Vectors**: Produce input/output data pairs from the trained Layer 1 to verify the correctness of the hardware design.

#### Track 2: Hardware (RTL Implementation)
This track focuses on the physical design of the `Conv1` accelerator.
1.  **RTL Coding**: Implement the core logic (XNOR array, Popcount, control unit) in Verilog or SystemVerilog.
2.  **Verification**: Create a test bench to simulate the RTL, feeding it the test vectors generated by the software track.
3.  **Synthesis**: Convert the verified RTL into a physical layout (GDSII) for fabrication.

## Current Status

The project is currently in the **Software track**, focusing on training and optimizing the "Golden Reference" model.

* **BNN Model Implemented**: The full 3-layer architecture, including custom `Binarize`, `BinarizedConv2d`, and `BinarizedLinear` layers, is complete in PyTorch.
* **Proof-of-Concept Training**: The model was successfully validated on a synthetic dataset, achieving near-perfect accuracy and proving the architecture's viability.
* **Training on Real-World Data**: The current focus is on training the model using a more realistic dataset. This dataset is generated on-the-fly using real-time **Two-Line Element (TLE)** orbital data for all tracked space objects, downloaded from Celestrak and processed using the `skyfield` library.

The next major phase will be the **Hardware (RTL) track**, which will begin once the software model's weights are finalized.

## How to Run the Software Model

This repository contains the complete code to train the "Golden Reference" BNN model.

### 1. Prerequisites
Ensure you have Python 3.8+ and the following libraries installed:
```bash
pip install torch numpy skyfield tqdm
